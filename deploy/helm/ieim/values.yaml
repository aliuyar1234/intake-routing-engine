image:
  api:
    repository: ieim-api
    tag: ""
    pullPolicy: IfNotPresent
  worker:
    repository: ieim-worker
    tag: ""
    pullPolicy: IfNotPresent
  scheduler:
    repository: ieim-scheduler
    tag: ""
    pullPolicy: IfNotPresent

serviceAccount:
  create: true
  name: ""

config:
  fileName: runtime.yaml
  content: |
    pack:
      system_id: IEIM
      canonical_spec_semver: "1.0.4"

    auth:
      oidc:
        enabled: false
        issuer_url: "disabled"
        audience: null
        actor_id_claim: "sub"
        roles_claim: "realm_access.roles"
        role_name_map: {}
        accepted_algorithms:
          - "RS256"
        leeway_seconds: 60
        http_timeout_seconds: 3
        direct_grant:
          enabled: false
          client_id: "disabled"
          client_secret: null

    runtime:
      determinism_mode: false
      supported_languages:
        - de
        - en

    incident:
      force_review: false
      force_review_queue_id: "QUEUE_INTAKE_REVIEW_GENERAL"
      disable_llm: false
      block_case_create_risk_flags_any: []

    identity:
      top_k: 5
      thresholds:
        confirmed_min_score: 0.90
        confirmed_min_margin: 0.20
        probable_min_score: 0.75
        probable_min_margin: 0.12
      shared_mailbox_penalty: 0.20
      signal_weights:
        SIG_POLICY_NUMBER_LOOKUP_MATCH:
          weight: 0.75
          strength: 1.0
        SIG_CLAIM_NUMBER_LOOKUP_MATCH:
          weight: 0.80
          strength: 1.0
        SIG_SENDER_EMAIL_MATCH:
          weight: 0.20
          strength: 0.70
      scoring:
        intercept: 0.8
        slope: 0.15

    classification:
      min_confidence_for_auto: 0.80
      rules_version: "1.0.0"
      llm:
        enabled: false
        provider: "disabled"
        model_name: "disabled"
        model_version: "disabled"
        prompt_versions:
          classify: "1.0.0"
          extract: "1.0.0"
        token_budgets:
          classify: 900
          extract: 1200
        max_calls_per_day: 0

    extraction:
      iban_policy:
        enabled: true
        store_mode: "HASH_ONLY"

    routing:
      ruleset_path: "configs/routing_tables/routing_rules_v1.4.1.json"
      ruleset_version: "1.4.1"

    retention:
      raw_days: 180
      normalized_days: 365
      audit_years: 7

    rbac:
      role_mappings:
        agent:
          can_view_raw: false
          can_view_audit: true
          can_approve_drafts: false
        reviewer:
          can_view_raw: true
          can_view_audit: true
          can_approve_drafts: true
        privacy_officer:
          can_view_raw: true
          can_view_audit: true
          can_approve_drafts: true
        security_officer:
          can_view_raw: true
          can_view_audit: true
          can_approve_drafts: false
        administrator:
          can_view_raw: true
          can_view_audit: true
          can_approve_drafts: true

service:
  type: ClusterIP
  port: 8080

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: ieim.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 10001
  runAsGroup: 10001
  fsGroup: 10001

containerSecurityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

resources:
  api:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  worker:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  scheduler:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

replicas:
  api: 1
  worker: 1
  scheduler: 1

autoscaling:
  worker:
    enabled: false
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 70

external:
  postgres:
    host: ""
    port: 5432
    database: ""
    username: ""
    passwordSecretRef:
      name: ""
      key: ""
  rabbitmq:
    host: ""
    port: 5672
    username: ""
    passwordSecretRef:
      name: ""
      key: ""
  s3:
    endpoint: ""
    region: ""
    bucket: ""
    accessKeySecretRef:
      name: ""
      key: ""
    secretKeySecretRef:
      name: ""
      key: ""
  oidc:
    issuerUrl: ""
    clientId: ""
    clientSecretRef:
      name: ""
      key: ""

cronjobs:
  auditVerify:
    enabled: false
    schedule: "0 */6 * * *"
    auditDir: "/var/lib/ieim/audit"
  retention:
    enabled: false
    schedule: "0 2 * * *"
    baseDir: "/var/lib/ieim"
    normalizedDir: "/var/lib/ieim/normalized"
    attachmentsDir: "/var/lib/ieim/attachments"
    apply: false

persistence:
  enabled: false
  existingClaim: ""
  size: 10Gi
  storageClassName: ""
  accessModes:
    - ReadWriteOnce
